
<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Frohnhof ‚Äì Winterregeln Quiz (final)</title>
<style>
  :root{
    --accent:#5b6b7a; /* neutral grau-blau */
    --accent-light:#e9eef2;
    --good:#2e7d32;
    --warn:#f9a825;
    --bad:#c62828;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    line-height:1.6;
    margin:0;
    color:#0f172a;
    background:#fafbfc;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }
  .container{
    max-width: 960px;
    margin: 20px auto 48px;
    padding: 0 16px;
  }
  header.hero{
    background:linear-gradient(180deg, var(--accent-light), #fff);
    border:1px solid #d7dee5;
    border-radius:16px;
    padding:20px;
    margin-bottom:16px;
  }
  header.hero h1{
    margin:6px 0 6px 0;
    font-size: clamp(20px, 3vw, 30px);
    color: var(--accent);
  }
  header.hero p{ margin:0; color:#475569 }
  .card{
    background:#fff;
    border:1px solid #e3e8ee;
    border-radius:14px;
    padding:18px 18px;
    margin:14px 0;
    box-shadow: 0 1px 2px rgba(15,23,42,0.04);
  }
  .intro{
    background:#f7f9fc;
    border:1px solid #d7dee5;
    border-radius:14px;
    padding:16px 16px;
  }
  .intro h2{
    margin:0 0 6px 0;
    font-size:18px;
    color:#1f2937;
  }
  .intro p{ margin:6px 0; color:#334155 }
  .meta{
    display:grid;
    grid-template-columns: 1fr 1fr;
    gap:12px;
    margin: 8px 0 6px;
  }
  @media (max-width: 640px){
    .meta{ grid-template-columns: 1fr }
  }
  label{font-weight:600; color:#334155}
  input[type="text"], input[type="email"]{
    width:100%;
    padding:12px 13px;
    border:1px solid #cbd5e1;
    border-radius:10px;
    background:#fff;
    font-size:16px;
  }
  .hint{
    background: var(--accent-light);
    border-left: 4px solid var(--accent);
    padding:10px 12px;
    border-radius:8px;
    color:#334155;
    font-size:14px;
    margin-top:8px;
  }
  .section-title{
    font-size:18px;
    color: var(--accent);
    border-bottom:1px solid #d7dee5;
    padding-bottom:6px;
    margin-top:6px;
  }
  .question{
    margin-top: 8px;
    border-top: 1px dashed #e2e8f0;
    padding-top: 14px;
  }
  .q-title{
    font-weight:700;
    color:#1f2937;
  }
  .options{
    margin-top:10px;
    display:grid;
    gap:10px;
  }
  .opt{
    border:1px solid #e2e8f0;
    border-radius:12px;
    padding:12px 14px;
    display:flex;
    gap:12px;
    align-items:flex-start;
    transition: border-color .15s ease, background .15s ease;
    background:#fff;
  }
  .opt:hover{ border-color:#94a3b8; background:#f9fbff }
  .opt input{ margin-top:3px; transform: scale(1.2); }
  .badge{
    display:inline-block;
    padding:2px 8px;
    border-radius:999px;
    font-size:12px;
    font-weight:600;
    color:#334155;
    background:#eef2f6;
    margin-left:6px;
  }
  .actions{
    display:flex;
    gap:12px;
    flex-wrap:wrap;
    margin-top: 12px;
  }
  button{
    appearance:none;
    border:none;
    border-radius:10px;
    padding:12px 16px;
    font-weight:700;
    cursor:pointer;
    font-size:16px;
  }
  .primary{
    background: var(--accent);
    color:#fff;
  }
  .secondary{
    background:#e2e8f0;
    color:#0f172a;
  }
  .result{
    margin-top:16px;
    padding:14px;
    border-radius:12px;
    border:1px solid #e2e8f0;
    background:#fff;
  }
  .result.good{ border-color: var(--good); box-shadow: inset 0 0 0 2px rgba(46,125,50,.08) }
  .result.warn{ border-color: var(--warn); box-shadow: inset 0 0 0 2px rgba(249,168,37,.10) }
  .result.bad{  border-color: var(--bad);  box-shadow: inset 0 0 0 2px rgba(198,40,40,.10) }
  .result h3{ margin:0 0 6px 0 }
  .score-line{ color:#334155 }
  footer{
    margin-top:24px;
    color:#64748b;
    font-size:12px;
    text-align:center;
  }
  .sr-only{position:absolute;left:-10000px;top:auto;width:1px;height:1px;overflow:hidden;}
</style>
</head>
<body>
  <noscript>
    <div style="max-width:960px;margin:20px auto;padding:12px;border:1px solid #e2e8f0;background:#fff;border-radius:12px;color:#b91c1c">
      Dieses Quiz ben√∂tigt JavaScript. Bitte im Browser aktivieren.
    </div>
  </noscript>

  <div class="container">
    <header class="hero" role="banner" aria-label="Einleitung">
      <h1>Winterregeln ‚Äì Quiz f√ºr Mitarbeiter</h1>
      <p>Dies ist ein Lernquiz zur internen Stallanweisung f√ºr die Wintermonate.</p>
    </header>

    <section class="card intro" role="region" aria-label="Grundsatz">
      <h2>Worum geht es?</h2>
      <p><b>Grundsatz:</b> Bei sinkenden Temperaturen ist der Schutz von <b>Pferden</b>, <b>Stallanlage</b> und <b>Wasserleitungen</b> oberste Priorit√§t. Unsere Stallgeb√§ude haben dicke Mauern, speichern W√§rme gut und werden durch die K√∂rperw√§rme der Pferde zus√§tzlich aufgeheizt. Zugluft muss konsequent vermieden werden, um Frostsch√§den und Erkrankungen vorzubeugen.</p>
      <p>Ma√ünahmen steigern sich je nach Temperatur: <b>unter 10&nbsp;¬∞C</b> (K√§lte) schlie√üen wir T√ºren/Fenster, stabilisieren das Stallklima und beachten das Deckenmanagement. <b>Unter 0&nbsp;¬∞C</b> (Frost) kommen zus√§tzliche Schritte f√ºr Leitungen/Tr√§nken und Au√üenbereiche hinzu.</p>
      <p>Dieses Quiz hilft dir, die richtigen Entscheidungen im Alltag zu treffen.</p>
    </section>

    <section class="card" role="region" aria-label="Teilnehmerangaben">
      <div class="section-title">Deine Angaben</div>
      <div class="meta">
        <div>
          <label for="name">Name</label>
          <input id="name" type="text" placeholder="Vor- und Nachname" autocomplete="name">
        </div>
        <div>
          <label for="email">E‚ÄëMail</label>
          <input id="email" type="email" placeholder="name@beispiel.de" autocomplete="email">
        </div>
      </div>
      <div class="hint">Diese Angaben werden zusammen mit deinem Ergebnis √ºbermittelt (falls Benachrichtigung aktiviert ist).</div>
    </section>

    <form id="quizForm" class="card" role="form" aria-label="Quizformular">
      <div class="section-title">Fragen</div>

      <div id="questions"></div>

      <div class="actions">
        <button type="button" class="secondary" id="showAnswersBtn" disabled>Antworten anzeigen</button>
        <button type="submit" class="primary">Auswerten</button>
        <button type="button" class="secondary" id="resetBtn">Zur√ºcksetzen</button>
      </div>

      <div id="resultBox" class="result" style="display:none;" aria-live="polite"></div>
    </form>

    <footer>Frohnhof ‚Äì Lernmodul Winterregeln</footer>
  </div>

<script>
// ===== CONFIG =====
const WEBHOOK_URL = ""; // Optional: Power Automate "When an HTTP request is received" URL (leave empty to disable)
const PASS_GREEN = 85;  // %
const PASS_YELLOW = 60; // %

// ===== QUESTION SET =====
// type: 'single' (radio) or 'multi' (checkbox)
// correct: array of indices of correct options (0-based)
const QUESTIONS = [
  {
    q: "Ab welcher Au√üentemperatur sind Stallt√ºren und Fenster geschlossen zu halten?",
    type: "single",
    options: ["Unter 5 ¬∞C", "Unter 10 ¬∞C", "Unter 0 ¬∞C (Frost)"],
    correct: [1]
  },
  {
    q: "Welche Aussage ist korrekt zum Unterschied zwischen K√§lte und Frost? (Mehrfachauswahl m√∂glich)",
    type: "multi",
    options: [
      "K√§lte = unter 10 ¬∞C: T√ºren/Fenster schlie√üen, Stallklima stabil halten",
      "Frost = unter 0 ¬∞C: zus√§tzliche Leitungs-/Tr√§nkenma√ünahmen",
      "Frostma√ünahmen gelten schon ab 8 ¬∞C"
    ],
    correct: [0,1]
  },
  {
    q: "Warum vermeiden wir Zugluft im Stall?",
    type: "single",
    options: [
      "Zugluft ist egal, Hauptsache es ist trocken",
      "Zugluft k√ºhlt Geb√§ude und Leitungen aus und f√∂rdert Verspannungen/Atemwegsprobleme",
      "Nur wegen Geruch"
    ],
    correct: [1]
  },
  {
    q: "In welchen Stallbereichen bleibt es meist √ºber dem Gefrierpunkt, wenn T√ºren/Tore geschlossen sind? (Mehrfachauswahl m√∂glich)",
    type: "multi",
    options: ["Pferdestall", "Kuhstall", "Schweinestall", "Nur Au√üenboxen"],
    correct: [0,1,2]
  },
  {
    q: "Was ist bei Frost mit den Tr√§nkeleitungen sicherzustellen?",
    type: "single",
    options: [
      "Dass das Wasser in Bewegung bleibt (z. B. Wasserhahn im Reitschul-WC leicht √∂ffnen)",
      "Alle Leitungen komplett entleeren, auch tags√ºber",
      "Nichts ‚Äì dicke W√§nde reichen aus"
    ],
    correct: [0]
  },
  {
    q: "Welche Zusatzma√ünahmen sch√ºtzen Leitungen in Au√üenboxen? (Mehrfachauswahl m√∂glich)",
    type: "multi",
    options: [
      "Begleitheizung pr√ºfen",
      "Isolierung auf Sch√§den pr√ºfen",
      "Gardena-Anschluss am Wasserhahn entfernen",
      "Schl√§uche gef√ºllt liegen lassen"
    ],
    correct: [0,1]  // KORREKTUR: Gardena-Anschluss entfernen geh√∂rt bei euch nicht zu den Standardma√ünahmen
  },
  {
    q: "Wie sind Wasserh√§hne bei Frostgefahr zu stellen?",
    type: "single",
    options: [
      "Innen ge√∂ffnet, au√üen geschlossen",
      "Innen abgedreht (geschlossen), au√üen ge√∂ffnet ‚Äì damit sich Eis ausdehnen kann",
      "Alle schlie√üen"
    ],
    correct: [1]
  },
  {
    q: "F√ºr welche Boxen gilt das Anlassmisten (10 cm Matte unter frischem Stroh)?",
    type: "single",
    options: [
      "Nur Innenboxen",
      "Nur Au√üenboxen",
      "Innen- und Au√üenboxen"
    ],
    correct: [0]
  },
  {
    q: "Was geh√∂rt beim Anlassmisten zur t√§glichen Routine? (Mehrfachauswahl m√∂glich)",
    type: "multi",
    options: [
      "Pferde√§ppel t√§glich entfernen",
      "Dunkelbraunes/stark verschmutztes Stroh entfernen",
      "T√§glich einen kleinen Teil der Matte abnehmen",
      "Die Matte unbegrenzt wachsen lassen"
    ],
    correct: [0,1,2]
  },
  {
    q: "Wie wird in Au√üenboxen gemistet?",
    type: "single",
    options: [
      "Wie in Innenboxen (Matte)",
      "Normal misten ‚Äì keine Matte",
      "Gar nicht misten im Winter"
    ],
    correct: [1]
  },
  {
    q: "Ab welcher Temperatur erhalten Pferde in Au√üenboxen Decken?",
    type: "single",
    options: ["Ab 14 ¬∞C", "Ab 10 ¬∞C", "Erst unter 0 ¬∞C"],
    correct: [1]
  },
  {
    q: "Wann sollen Decken tags√ºber abgenommen werden?",
    type: "single",
    options: [
      "Wenn Sonne scheint und die Temperaturen √ºber 12‚Äì14 ¬∞C steigen",
      "Nie ‚Äì Decken bleiben immer drauf",
      "Erst wenn es √ºber 20 ¬∞C ist"
    ],
    correct: [0]
  },
  {
    q: "Bei Regen oder stark matschigem Wetter um 10 ¬∞C ‚Ä¶",
    type: "single",
    options: [
      "k√∂nnen Decken auch tags√ºber auf den Pferden bleiben, um Verschmutzung zu vermeiden",
      "m√ºssen Decken sofort runter",
      "ist die Entscheidung egal"
    ],
    correct: [0]
  },
  {
    q: "Warum hilft Eindecken bei nasskaltem Wetter zus√§tzlich im Reitbetrieb? (Mehrfachauswahl m√∂glich)",
    type: "multi",
    options: [
      "Weniger Putzzeit ‚Äì mehr Zeit f√ºr die Arbeit im Sattel",
      "Weniger √ºberm√§√üiger Winterfellaufbau",
      "St√§rkeres Schwitzen wird vermieden, weniger Trockenreit-/Nacharbeitszeit",
      "Damit Pferde nie mehr geputzt werden m√ºssen"
    ],
    correct: [0,1,2]
  },
  {
    q: "Wie wird die Deckenentscheidung f√ºr die Schulpferde getroffen?",
    type: "single",
    options: [
      "Einheitlich f√ºr alle Schulpferde, basierend auf Temperatur, Wind, Feuchtigkeit und Regenprognose",
      "Jeder macht es, wie er m√∂chte",
      "Nur nach Laune der Reiter"
    ],
    correct: [0]
  },
  {
    q: "Welche Aussagen zu Zugluft sind korrekt? (Mehrfachauswahl m√∂glich)",
    type: "multi",
    options: [
      "Zugluft senkt die Stalltemperatur und k√ºhlt Leitungen aus",
      "Zugluft kann Atemwegsprobleme und Verspannungen beg√ºnstigen",
      "Zugluft ist bei Frost unproblematisch"
    ],
    correct: [0,1]
  },
  {
    q: "Welche Routinekontrolle geh√∂rt zu jeder Schicht?",
    type: "single",
    options: [
      "Pr√ºfen, ob alle T√ºren/Fenster vollst√§ndig geschlossen sind (besonders abends)",
      "Nur morgens einmal gucken",
      "Gar keine ‚Äì das merkt man schon"
    ],
    correct: [0]
  },
  {
    q: "Was ist bei Schl√§uchen nach Gebrauch im Winter zu beachten?",
    type: "single",
    options: [
      "Gef√ºllt liegen lassen, damit es schneller geht",
      "Komplett entleeren und abh√§ngen",
      "Nur im Sommer entleeren"
    ],
    correct: [1]
  }
];

// ===== RENDER =====
function renderQuestions(){
  const wrap = document.getElementById('questions');
  wrap.innerHTML = "";
  QUESTIONS.forEach((item, idx) => {
    const qDiv = document.createElement('div');
    qDiv.className = 'question';
    const badge = item.type === 'multi' ? '<span class="badge">Mehrfachauswahl m√∂glich</span>' : '';
    qDiv.innerHTML = `
      <div class="q-title">Frage ${idx+1}: ${item.q} ${badge}</div>
      <div class="options" role="group" aria-label="Antwortm√∂glichkeiten f√ºr Frage ${idx+1}"></div>
    `;
    const optWrap = qDiv.querySelector('.options');
    item.options.forEach((opt, oi) => {
      const id = `q${idx}_o${oi}`;
      const type = item.type === 'multi' ? 'checkbox' : 'radio';
      const name = item.type === 'multi' ? id : `q${idx}`;
      const optEl = document.createElement('label');
      optEl.className = 'opt';
      optEl.setAttribute('tabindex','0');
      optEl.innerHTML = `
        <input type="${type}" name="${name}" value="${oi}" id="${id}">
        <span>${opt}</span>
      `;
      optWrap.appendChild(optEl);
    });
    wrap.appendChild(qDiv);
  });
}
renderQuestions();

// ===== HELPERS =====
function getSelections(){
  const selections = [];
  QUESTIONS.forEach((q, qi) => {
    const sel = [];
    if(q.type === 'multi'){
      q.options.forEach((_, oi) => {
        const el = document.getElementById(`q${qi}_o${oi}`);
        if(el && el.checked) sel.push(oi);
      });
    }else{
      const radios = document.querySelectorAll(`input[name="q${qi}"]`);
      radios.forEach(r => { if(r.checked) sel.push(parseInt(r.value)) });
    }
    selections.push(sel);
  });
  return selections;
}
function arraysEqual(a,b){
  if(a.length !== b.length) return false;
  const s1 = [...a].sort(); const s2 = [...b].sort();
  return s1.every((v,i)=>v===s2[i]);
}
function scoreQuiz(selections){
  let correctCount = 0;
  const details = [];
  selections.forEach((sel, i)=>{
    const ok = arraysEqual(sel, QUESTIONS[i].correct);
    if(ok) correctCount++;
    details.push({index:i+1, selected:sel, correct:QUESTIONS[i].correct, ok});
  });
  const total = QUESTIONS.length;
  const percent = Math.round((correctCount/total)*100);
  return {correctCount, total, percent, details};
}
function colorClass(percent){
  if(percent >= PASS_GREEN) return 'good';
  if(percent >= PASS_YELLOW) return 'warn';
  return 'bad';
}
function humanizeAnswers(arr, opts){ 
  if(!arr.length) return "keine Auswahl";
  return arr.map(i => opts[i]).join(" | ");
}

// ===== SUBMIT =====
const form = document.getElementById('quizForm');
const resultBox = document.getElementById('resultBox');
const showBtn = document.getElementById('showAnswersBtn');
const resetBtn = document.getElementById('resetBtn');

let lastResult = null;
let answersVisible = false;

form.addEventListener('submit', async (e)=>{
  e.preventDefault();
  const name = document.getElementById('name').value.trim();
  const email = document.getElementById('email').value.trim();
  const selections = getSelections();
  const result = scoreQuiz(selections);
  lastResult = {name, email, selections, result};
  answersVisible = false;
  showBtn.disabled = false;

  const cls = colorClass(result.percent);
  resultBox.className = `result ${cls}`;
  resultBox.style.display = 'block';
  resultBox.innerHTML = `
    <h3>Dein Ergebnis: ${result.correctCount} / ${result.total} richtig (${result.percent}%)</h3>
    <div class="score-line">
      <b>Status:</b> ${
        cls==='good' ? '‚úÖ Gr√ºn ‚Äì sehr gut!' : cls==='warn' ? 'üü® Gelb ‚Äì da geht noch was.' : 'üü• Rot ‚Äì bitte Winterregeln √ºben.'
      }
    </div>
    <div style="margin-top:6px; font-size:14px; color:#475569">Klicke auf ‚ÄûAntworten anzeigen‚Äú, um alle L√∂sungen und deine Auswahl zu sehen.</div>
  `;

  // Optional webhook
  if(WEBHOOK_URL){
    const payload = {
      timestamp: new Date().toISOString(),
      name, email,
      score: result.percent,
      correct: result.correctCount,
      total: result.total,
      answers: result.details.map(d => ({
        question: d.index,
        selected: d.selected,
        correct: d.correct,
        ok: d.ok
      }))
    };
    try{
      await fetch(WEBHOOK_URL, {
        method: 'POST',
        headers: {'Content-Type':'application/json'},
        body: JSON.stringify(payload)
      });
    }catch(err){
      console.warn("Webhook-√úbermittlung fehlgeschlagen:", err);
    }
  }
});

showBtn.addEventListener('click', ()=>{
  if(!lastResult) return;
  if(answersVisible) return;
  answersVisible = true;

  const { selections, result } = lastResult;
  const list = document.createElement('div');
  list.style.marginTop = '10px';
  QUESTIONS.forEach((q, qi)=>{
    const row = document.createElement('div');
    row.style.borderTop = '1px dashed #e2e8f0';
    row.style.paddingTop = '10px';
    const ok = result.details[qi].ok;
    const mark = ok ? '‚úÖ' : '‚ùå';
    row.innerHTML = `
      <div style="font-weight:700; color:#1f2937">${mark} Frage ${qi+1}: ${q.q}</div>
      <div style="margin-top:4px; font-size:14px">
        <div><b>Deine Auswahl:</b> ${humanizeAnswers(selections[qi], q.options)}</div>
        <div><b>Korrekte L√∂sung:</b> ${humanizeAnswers(QUESTIONS[qi].correct, q.options)}</div>
      </div>
    `;
    list.appendChild(row);
  });
  resultBox.appendChild(list);
  showBtn.disabled = true;
});

resetBtn.addEventListener('click', ()=>{
  document.getElementById('quizForm').reset();
  document.getElementById('name').value = "";
  document.getElementById('email').value = "";
  resultBox.style.display = 'none';
  resultBox.innerHTML = "";
  showBtn.disabled = true;
  answersVisible = false;
  window.scrollTo({top:0, behavior:"smooth"});
});

</script>
</body>
</html>
